import re
import random
import logging
from logging.handlers import RotatingFileHandler
import spacy
from fuzzywuzzy import fuzz
from difflib import get_close_matches
import sqlite3
from pathlib import Path

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logger = logging.getLogger()
logger.setLevel(logging.DEBUG)
formatter = logging.Formatter('%(asctime)s - %(levelname)s - %(message)s')
file_handler = RotatingFileHandler('bot.log', maxBytes=5*1024*1024, backupCount=5)
file_handler.setLevel(logging.DEBUG)
file_handler.setFormatter(formatter)
logger.addHandler(file_handler)

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
unrecognized_handler = RotatingFileHandler('unrecognized.log', maxBytes=5*1024*1024, backupCount=5)
unrecognized_handler.setLevel(logging.INFO)
unrecognized_handler.setFormatter(formatter)
logger.addHandler(unrecognized_handler)

console_handler = logging.StreamHandler()
console_handler.setLevel(logging.INFO)
console_handler.setFormatter(formatter)
logger.addHandler(console_handler)


class NLPProcessor:
    def __init__(self):
        logging.info("Initializing NLPProcessor")
        try:
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –º–æ–¥–µ–ª–∏
            if not spacy.util.is_package("ru_core_news_sm"):
                logging.error("Model 'ru_core_news_sm' not found. Please run 'python -m spacy download ru_core_news_sm'")
                raise ImportError("Model 'ru_core_news_sm' not found")
            self.nlp = spacy.load("ru_core_news_sm")
            logging.info("SpaCy model 'ru_core_news_sm' loaded successfully")
            self._init_db()
            self._init_typo_dictionary()
            self._init_knowledge_base()
            logging.debug("Knowledge base, typo dictionary, and database initialized")
        except Exception as e:
            logging.error(f"Initialization error: {e}", exc_info=True)
            raise

    def _init_db(self):
        #–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–ª–æ–≤ –∏ –æ—à–∏–±–æ–∫
        logging.debug("Initializing SQLite database")
        try:
            self.db_path = Path("typo_database.db")
            conn = sqlite3.connect(self.db_path)
            cursor = conn.cursor()
            cursor.execute('''
                CREATE TABLE IF NOT EXISTS typos (
                    correct_word TEXT,
                    typo TEXT,
                    frequency INTEGER DEFAULT 1,
                    PRIMARY KEY (correct_word, typo)
                )
            ''')
            cursor.execute('''
                CREATE TABLE IF NOT EXISTS unrecognized_queries (
                    query TEXT,
                    frequency INTEGER DEFAULT 1,
                    PRIMARY KEY (query)
                )
            ''')
            conn.commit()
            cursor.execute("SELECT name FROM sqlite_master WHERE type='table'")
            tables = cursor.fetchall()
            logging.info(f"Tables in database: {tables}")
            cursor.execute("SELECT correct_word, typo, frequency FROM typos")
            typos = cursor.fetchall()
            logging.debug(f"Typos in database: {typos}")
            conn.close()
            logging.info("SQLite database initialized")
        except Exception as e:
            logging.error(f"Database initialization error: {e}", exc_info=True)

    def _add_typo_to_db(self, correct_word, typo):
        #–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ—à–∏–±–æ—á–Ω–æ–≥–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
        try:
            conn = sqlite3.connect(self.db_path)
            cursor = conn.cursor()
            cursor.execute('''
                INSERT OR REPLACE INTO typos (correct_word, typo, frequency)
                VALUES (?, ?, COALESCE((SELECT frequency + 1 FROM typos WHERE correct_word = ? AND typo = ?), 1))
            ''', (correct_word, typo, correct_word, typo))
            conn.commit()
            conn.close()
            logging.debug(f"Added typo '{typo}' for '{correct_word}' to database")
        except Exception as e:
            logging.error(f"Error adding typo to database: {e}", exc_info=True)

    def _add_unrecognized_query_to_db(self, query):
        #–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö#
        try:
            conn = sqlite3.connect(self.db_path)
            cursor = conn.cursor()
            cursor.execute('''
                INSERT OR REPLACE INTO unrecognized_queries (query, frequency)
                VALUES (?, COALESCE((SELECT frequency + 1 FROM unrecognized_queries WHERE query = ?), 1))
            ''', (query, query))
            conn.commit()
            conn.close()
            logging.debug(f"Added unrecognized query '{query}' to database")
        except Exception as e:
            logging.error(f"Error adding unrecognized query to database: {e}", exc_info=True)

    def _init_typo_dictionary(self):
        #–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ–≤–∞—Ä—è —á–∞—Å—Ç—ã—Ö –æ—à–∏–±–æ–∫
        logging.debug("Initializing typo dictionary")
        self.typo_dictionary = {
            "–ø—Ä–∏–≤–µ—Ç": ["–ø—Ä–∏—Ñ–µ—Ç", "–ø—Ä–∏–≤–µ—Ç—Ç", "–ø—Ä–∏–≤–µ—Ç–∏–∫", "–ø—Ä–∏–≤—Ç"],
            "–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ": ["–≤–∏–¥–∏–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", "–≤–∏–¥–µ–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", "–≤–∏–¥–µ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", "–≤–∏–¥–∏–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ"],
            "–∫–∞–º–µ—Ä–∞": ["–∫–æ–º–µ—Ä–∞", "–∫–∞–º–µ—Ä—Ä–∞", "–∫–º–µ—Ä–∞"],
            "—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è": ["—Ç–µ–ª–∏—Ñ–æ–Ω–∏—è", "—Ç–µ–ª–µ—Ñ–æ–Ω–∏", "—Ç–µ–ª–∏—Ñ–æ–Ω—è"],
            "ip —Ç–µ–ª–µ—Ñ–æ–Ω–∏—è": ["–∏–ø —Ç–µ–ª–µ—Ñ–æ–Ω–∏—è", "ip —Ç–∏–ª–∏—Ñ–æ–Ω–∏—è", "–∞–π–ø–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∏—è"],
            "iptv": ["–∏–ø—Ç–≤", "ip tv", "–∞–π–ø–∏—Ç–∏–≤–∏", "–∏–ø —Ç–≤"],
            "—Ç–µ–ª–µ–≤–∏–∑–æ—Ä": ["—Ç–∏–ª–∏–≤–∏–∑–æ—Ä", "—Ç–µ–ª–∏–≤–∑–æ—Ä", "—Ç–µ–ª–µ–≤–∏–∑–∏—Ä"],
            "–∏–Ω—Ç–µ—Ä–Ω–µ—Ç": ["–∏–Ω—Ç–µ—Ä–µ–Ω–µ—Ç", "–∏–Ω—Ç—Ä–Ω–µ—Ç", "–∏–Ω—Ç–µ—Ä–Ω–µ—Ç—Ç", "–∏–Ω–µ—Ç—Ä–Ω–µ—Ç","–∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∏–∫"],
            "–Ω–∞—Å—Ç—Ä–æ–π–∫–∞": ["–Ω–∞—Å—Ç—Ä–æ–∫–π–∞", "–Ω–∞—Å—Ç—Ä–æ–π–∫", "–Ω–∞—Å—Ç—Ä–æ–∏–∫–∞"],
            "–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ": ["–ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–∏–µ", "–ø–æ–¥–∫–ª—é—á–Ω–∏–µ", "–ø–æ–¥–∫–ª—é–µ–Ω–∏–µ"],
            "—Ç–∞—Ä–∏—Ñ": ["—Ç–∞—Ä–∏—Ñ—Ñ—ã", "—Ç–∞—Ä–∏—Ñ–∏", "—Ç–∞—Ä–∏—Ñ", "—Ç–∞—Ä–∏—Ñ—ã"],
            "–∫–∞—á–µ—Å—Ç–≤–æ": ["–∫–∞—á–µ—Å—Ç—Ç–≤–æ", "–∫–∞—á—Å—Ç–≤–æ", "–∫–∞—á–µ—Ç–≤–æ"],
            "—Å–∏–≥–Ω–∞–ª": ["—Å–∏–≥–Ω–ª", "—Å–≥–Ω–∞–ª", "—Å–∏–≥–Ω–∞–ª–ª"],
        }
        try:
            if hasattr(self, 'db_path'):
                conn = sqlite3.connect(self.db_path)
                cursor = conn.cursor()
                cursor.execute("SELECT correct_word, typo FROM typos")
                for correct_word, typo in cursor.fetchall():
                    if correct_word in self.typo_dictionary:
                        self.typo_dictionary[correct_word].append(typo)
                    else:
                        self.typo_dictionary[correct_word] = [typo]
                conn.close()
                logging.debug("Typo dictionary loaded from database")
            else:
                logging.warning("db_path not initialized, skipping typo dictionary load from database")
        except Exception as e:
            logging.error(f"Error loading typos from database: {e}", exc_info=True)

    def _init_knowledge_base(self):
        #–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π —Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏ –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏
        #–µ—ë –∂–µ –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏.
        logging.debug("Initializing knowledge base")
        self.knowledge_base = [
            {
                "patterns": [
                    r"(–ø—Ä–∏–≤–µ—Ç|–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π|–¥–æ–±—Ä—ã–π|—Ö–∞–π|–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é|–∑–¥–∞—Ä–æ–≤|hi|hello|–∑–¥—Ä–∞—Å—Ç–µ|–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é)",
                    r"(.*)–ø—Ä–∏–≤–µ—Ç(.*)",
                    r"(.*)–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π(.*)",
                    r"(.*)–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é(.*)"
                ],
                "keywords": ["–ø—Ä–∏–≤–µ—Ç", "–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π", "–¥–æ–±—Ä—ã–π", "–ø—Ä–∏—Ñ–µ—Ç"],
                "responses": [
                    "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?",
                    "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ —è –º–æ–≥—É –≤–∞–º –ø–æ–º–æ—á—å —Å–µ–≥–æ–¥–Ω—è?",
                    "–î–æ–±—Ä—ã–π –¥–µ–Ω—å! –ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å."
                ]
            },
            {
                "patterns": [
                    r"(.*)–≥—Ä–∞—Ñ–∏–∫(.*)–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤(.*)",
                    r"(.*)—Ä–∞–±–æ—Ç–∞–µ—Ç(.*)–æ—Ñ–∏—Å(.*)–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤(.*)",
                    r"(.*)–≤—Ä–µ–º—è(.*)–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤(.*)"
                ],
                "keywords": ["–≥—Ä–∞—Ñ–∏–∫", "–∞–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤","—Ä–∞–±–æ—Ç—ã", "–≤—Ä–µ–º—è", "–æ—Ñ–∏—Å", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤"],
                "responses": [
                    "–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –æ—Ñ–∏—Å–∞ –≤ –≥. –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤: –ø–Ω-–ø—Ç —Å 9:00 –¥–æ 19:00, –≤—ã—Ö–æ–¥–Ω—ã–µ —Å 10:00 –¥–æ 17:00"
                ]
            },
            {
                "patterns": [
                    r"(.*)–≥—Ä–∞—Ñ–∏–∫(.*)–æ—Ñ–∏—Å(.*)–ö–∞—Ä–∞–±–∞–Ω–æ–≤–æ(.*)",
                    r"(.*)–≥—Ä–∞—Ñ–∏–∫(.*)–ö–∞—Ä–∞–±–∞–Ω–æ–≤–æ(.*)",
                    r"(.*)–≤—Ä–µ–º—è(.*)–æ—Ñ–∏—Å(.*)–ö–∞—Ä–∞–±–∞–Ω–æ–≤–æ(.*)",
                    r"(.*)—Ä–∞–±–æ—Ç–∞–µ—Ç(.*)–æ—Ñ–∏—Å(.*)–ö–∞—Ä–∞–±–∞–Ω–æ–≤–æ(.*)",
                    r"(.*)–≤—Ä–µ–º—è(.*)–ö–∞—Ä–∞–±–∞–Ω–æ–≤–æ(.*)"
                ],
                "keywords": ["–≥—Ä–∞—Ñ–∏–∫", "–ö–∞—Ä–∞–±–∞–Ω–æ–≤–æ","—Ä–∞–±–æ—Ç—ã", "–≤—Ä–µ–º—è", "–æ—Ñ–∏—Å"],
                "responses": [
                    "–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –æ—Ñ–∏—Å–∞ –≤ –≥. –ö–∞—Ä–∞–±–∞–Ω–æ–≤–æ: –≤—Ç-–ø—Ç —Å 9:00 –¥–æ 18:00, —Å—É–± —Å 10:00 –¥–æ 17:00, –≤—Å-–ø–Ω –≤—ã—Ö–æ–¥–Ω–æ–π"
                ]
            },
            { 
                "patterns":[
                    r"(–≥—Ä–∞—Ñ–∏–∫\s—Ä–∞–±–æ—Ç—ã\s–æ—Ñ–∏—Å–∞)"
                ],
                "keywords": ["–≥—Ä–∞—Ñ–∏–∫","—Ä–∞–±–æ—Ç—ã","–æ—Ñ–∏—Å–∞","–æ—Ñ–∏—Å–æ–≤"],
                "responses":[
                    "–î–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –æ—Ñ–∏—Å–∞. –Ω–∞–ø–∏—à–∏—Ç–µ –∫–∞–∫–æ–π –æ—Ñ–∏—Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç\n –í —Ñ–æ—Ä–º–∞—Ç–µ '–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –æ—Ñ–∏—Å–∞ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤'"
                ]

            },
            {
                "patterns": [
                    r"(.*)–≥—Ä–∞—Ñ–∏–∫(.*)–æ—Ñ–∏—Å(.*)–°—Ç—Ä—É–Ω–∏–Ω–æ(.*)",
                    r"(.*)–≥—Ä–∞—Ñ–∏–∫(.*)–°—Ç—Ä—É–Ω–∏–Ω–æ(.*)",
                    r"(.*)–≤—Ä–µ–º—è(.*)–æ—Ñ–∏—Å(.*)–°—Ç—Ä—É–Ω–∏–Ω–æ(.*)",
                    r"(.*)–≥—Ä–∞—Ñ–∏–∫–°—Ç—Ä—É–Ω–∏–Ω–æ(.*)",
                    r"(.*)—Ä–∞–±–æ—Ç–∞–µ—Ç(.*)–æ—Ñ–∏—Å(.*)–°—Ç—Ä—É–Ω–∏–Ω–æ(.*)",
                    r"(.*)–≤—Ä–µ–º—è(.*)–°—Ç—Ä—É–Ω–∏–Ω–æ(.*)"
                ],
                "keywords": ["–≥—Ä–∞—Ñ–∏–∫", "–°—Ç—Ä—É–Ω–∏–Ω–æ", "–≤—Ä–µ–º—è", "–æ—Ñ–∏—Å"],
                "responses": [
                    "–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –æ—Ñ–∏—Å–∞ –≤ –≥. –°—Ç—Ä—É–Ω–∏–Ω–æ: –≤—Ç-–ø—Ç —Å 9:00 –¥–æ 18:00, —Å—É–± —Å 10:00 –¥–æ 17:00, –≤—Å-–ø–Ω –≤—ã—Ö–æ–¥–Ω–æ–π"
                ]
            },
            {
                "patterns": [
                    r"(—Å–∫–æ–ª—å–∫–æ|–∫–æ–≥–¥–∞|–∫–∞–∫)–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ(.*)"
                ],
                "keywords": ["–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ","—Å–∫–æ–ª—å–∫–æ","–∫–æ–≥–¥–∞","–∫–∞–∫"],
                "responses": [
                    "–í—ã –±—ã —Ö–æ—Ç–µ–ª–∏ —É–∑–Ω–∞—Ç—å —á—Ç–æ-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ —É—Å–ª—É–≥–µ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–∏? \n–î–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è \n–º–æ–∂–µ—Ç–µ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(—Å–∫–æ–ª—å–∫–æ|–∫–æ–≥–¥–∞|–∫–∞–∫)(.*)–∏–Ω—Ç–µ—Ä–Ω–µ—Ç(.*)"
                ],
                "keywords": ["–∏–Ω—Ç–µ—Ä–Ω–µ—Ç","—Å–∫–æ–ª—å–∫–æ","–∫–æ–≥–¥–∞","–∫–∞–∫"],
                "responses": [
                    "–í—ã –±—ã —Ö–æ—Ç–µ–ª–∏ —É–∑–Ω–∞—Ç—å —á—Ç–æ-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ —É—Å–ª—É–≥–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç? \n–î–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ \n–º–æ–∂–µ—Ç–µ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(—Å–∫–æ–ª—å–∫–æ|–∫–æ–≥–¥–∞|–∫–∞–∫)(.*)—Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ(.*)"
                ],
                "keywords": ["—Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ","—Å–∫–æ–ª—å–∫–æ","–∫–æ–≥–¥–∞","–∫–∞–∫"],
                "responses": [
                    "–í—ã –±—ã —Ö–æ—Ç–µ–ª–∏ —É–∑–Ω–∞—Ç—å —á—Ç–æ-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ —É—Å–ª—É–≥–µ —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ? \n–î–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ \n–º–æ–∂–µ—Ç–µ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É 3-33-00"
                ]
            },
               {
                "patterns": [
                    r"(IPTV|ip-tv|–∏–Ω—Ç–µ—Ä–Ω–µ—Ç)(.*) —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ(.*)"
                ],
                "keywords": ["IPTV","ip-tv","–∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ"],
                "responses": [
                    "–í—ã –±—ã —Ö–æ—Ç–µ–ª–∏ —É–∑–Ω–∞—Ç—å —á—Ç–æ-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ —É—Å–ª—É–≥–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏—è? \n–î–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ \n–º–æ–∂–µ—Ç–µ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É 3-33-00"
                ]
            },
               {
                "patterns": [
                    r"–¢–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ"
                ],
                "keywords": ["—Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ"],
                "responses": [
                    "–í—ã –±—ã —Ö–æ—Ç–µ–ª–∏ —É–∑–Ω–∞—Ç—å —á—Ç–æ-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–∏? \n–î–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ \n–º–æ–∂–µ—Ç–µ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É 3-33-00"
                ]
            },
               {
                "patterns": [
                    r"–¢–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ"
                ],
                "keywords": ["—Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ"],
                "responses": [
                    "–í—ã –±—ã —Ö–æ—Ç–µ–ª–∏ —É–∑–Ω–∞—Ç—å —á—Ç–æ-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–∏? \n–î–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ \n–º–æ–∂–µ—Ç–µ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)—Å—Ç–æ–∏–º–æ—Å—Ç—å(.*)–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è",
                    r"(.*)–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ(.*)"
                ],
                "keywords": ["—Å—Ç–æ–∏–º–æ—Å—Ç—å", "–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ"],
                "responses": [
                    "–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∞–¥—Ä–µ—Å–∞. –î–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –∑–≤–æ–Ω–∏—Ç–µ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–ø–æ–º–æ–≥–∏)(.*)",
                    r"(.*)(–ø–æ–º–æ–≥–∏—Ç–µ)(.*)",
                    r"(.*)(—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è\s–ø–æ–¥–¥–µ—Ä–∂–∫–∞|—Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞|—Ç–µ—Ö\s–ø–æ–¥–¥–µ—Ä–∂–∫–∞|–ø–æ–º–æ—â—å)(.*)",
                    r"(–Ω–µ\s—Ä–∞–±–æ—Ç–∞–µ—Ç|–Ω–µ\s–≤–∫–ª—é—á–∞–µ—Ç—Å—è|—Å–ª–æ–º–∞–ª—Å—è|–≥–ª—é—á–∏—Ç|–Ω–µ\s–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç)(.*)",
                    r"(.*)(–ø—Ä–æ–±–ª–µ–º–∞|–æ—à–∏–±–∫–∞)(.*)(—Å–∞–π—Ç|–æ—à–∏–±–∫–∞)"
                ],
                "keywords": ["—Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞", "–ø—Ä–æ–±–ª–µ–º–∞", "–æ—à–∏–±–∫–∞", "–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç", "–ø–æ–º–æ–≥–∏—Ç–µ"],
                "responses": [
                    "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞ –æ–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:\n1. –ê–¥—Ä–µ—Å\n2. –•–∞—Ä–∞–∫—Ç–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã\n3. –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–Ω–µ\s—Ä–∞–±–æ—Ç–∞–µ—Ç|–Ω–µ\s–¥–æ—Å—Ç—É–ø–µ–Ω|–Ω–µ\s–≥—Ä—É–∑–∏—Ç|–Ω–µ\s–∑–∞–≥—Ä—É–∂–∞–µ—Ç|–Ω–µ\s–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è)(.*)(—Å–∞–π—Ç|—Ä–µ—Å—É—Ä—Å|—Å—Ç—Ä–∞–Ω–∏—Ü–∞|–ø–æ—Ä—Ç–∞–ª)(.*)",
                    r"(.*)(—Å–∞–π—Ç|—Ä–µ—Å—É—Ä—Å)(.*)(–Ω–µ\s–≥—Ä—É–∑–∏—Ç—Å—è|–Ω–µ\s–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è|–Ω–µ\s–¥–æ—Å—Ç—É–ø–µ–Ω)(.*)",
                    r"(.*)(–ø—Ä–æ–±–ª–µ–º–∞|–æ—à–∏–±–∫–∞)(.*)(–¥–æ—Å—Ç—É–ø\s–∫\s—Å–∞–π—Ç—É|–∑–∞–≥—Ä—É–∑–∫–∞\s—Å—Ç—Ä–∞–Ω–∏—Ü—ã)",
                    r"(.*)(–Ω–µ\s–º–æ–∂(–µ—Ç|–≥—É))(.*)(–∑–∞–π—Ç–∏|–ø–µ—Ä–µ–π—Ç–∏|–æ—Ç–∫—Ä—ã—Ç—å)(.*)(—Å–∞–π—Ç|—Ä–µ—Å—É—Ä—Å)"
                ],
                "keywords": ["—Å–∞–π—Ç", "–Ω–µ –≥—Ä—É–∑–∏—Ç—Å—è", "–æ—à–∏–±–∫–∞"],
                "responses": [
                    "–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Å–∞–π—Ç–∞–º:\n1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ\n2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –±—Ä–∞—É–∑–µ—Ä\n3. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞\n4. –ó–≤–æ–Ω–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–æ 3-33-00",
                    "–ï—Å–ª–∏ —Å–∞–π—Ç –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω:\n- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –¥—Ä—É–≥–∏—Ö —Å–∞–π—Ç–æ–≤\n- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ –º–æ–±–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç\n- –í–æ–∑–º–æ–∂–Ω–æ, –≤–µ–¥—É—Ç—Å—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–∫–æ–Ω—Ç–∞–∫—Ç—ã|—Ç–µ–ª–µ—Ñ–æ–Ω|–∫–∞–∫\s—Å–≤—è–∑–∞—Ç—å—Å—è)(.*)",
                    r"(.*)(–ø–æ–∑–≤–æ–Ω–∏—Ç—å|–Ω–∞–ø–∏—Å–∞—Ç—å)(.*)",
                    r"(.*)–≥–¥–µ\s–Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å(.*)"
                ],
                "keywords": ["–∫–æ–Ω—Ç–∞–∫—Ç—ã", "—Ç–µ–ª–µ—Ñ–æ–Ω", "–∞–¥—Ä–µ—Å"],
                "responses": [
                    "–ö–æ–Ω—Ç–∞–∫—Ç—ã:\nüìû –¢–µ–ª–µ—Ñ–æ–Ω: 8-492-443-33-00\nüìç –ê–¥—Ä–µ—Å: –≥. –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤, —É–ª. –û–∫—Ç—è–±—Ä—å—Å–∫–∞—è –¥.8, 1",
                    "–°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏: —Ç–µ–ª–µ—Ñ–æ–Ω 3-33-00 –∏–ª–∏ –æ–Ω–ª–∞–π–Ω-—á–∞—Ç –Ω–∞ —Å–∞–π—Ç–µ"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–Ω–µ—Ç\s–∏–Ω—Ç–µ—Ä–Ω–µ—Çs–∞|–Ω–µ\s—Ä–∞–±–æ—Ç–∞–µ—Ç)(.*)",
                    r"(.*)(–º–µ–¥–ª–µ–Ω–Ω—ã–π\s–∏–Ω—Ç–µ—Ä–Ω–µ—Ç|—Ç–æ—Ä–º–æ–∑–∏—Ç\s–∏–Ω—Ç–µ—Ä–Ω–µ—Ç)(.*)",
                    r"(.*)(–ø—Ä–æ–ø–∞–ª\s–∏–Ω—Ç–µ—Ä–Ω–µ—Ç)(.*)"
                ],
                "keywords": ["–∏–Ω—Ç–µ—Ä–Ω–µ—Ç",  "–º–µ–¥–ª–µ–Ω–Ω—ã–π","–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"],
                "responses": [
                    "–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º:\n1. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ä–æ—É—Ç–µ—Ä\n2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–±–µ–ª–∏\n3. –ó–≤–æ–Ω–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–æ 3-33-00"
                ]
            },
             {
                "patterns": [
                    r"(.*)(–Ω–∏–∑–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å| —Å–ª–∞–±—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç)(.*)",
                    r"(.*) (–ø–ª–æ—Ö–æ),(—Ä–∞–±–æ—Ç–∞–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç)(.*)"
                ],
                "keywords": ["–ø–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞–µ—Ç", "–Ω–∏–∑–∫–∞—è", "—Å–∫–æ—Ä–æ—Å—Ç—å", "—Å–ª–∞–±—ã–π", "–∏–Ω—Ç–µ—Ä–Ω–µ—Ç"],
                "responses": [
                    "–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å–æ —Å–∫–æ—Ä–æ—Å—Ç—å—é –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏:\n1.–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ Wi-Fi \n2. –ó–∞–º–µ—Ä—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è https://www.speedtest.net/ \n3. –°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞: 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(–Ω–µ\s—Ä–∞–±–æ—Ç–∞–µ—Ç|–Ω–µ\s–≤–∫–ª—é—á–∞–µ—Ç—Å—è|–≥–ª—é—á–∏—Ç)(.*)(—Ç–µ–ª–µ—Ñ–æ–Ω|—Å–º–∞—Ä—Ç—Ñ–æ–Ω|–∞–Ω–¥—Ä–æ–∏–¥)",
                    r"(–ø—Ä–æ–±–ª–µ–º–∞|–æ—à–∏–±–∫–∞)(.*)(—Ç–µ–ª–µ—Ñ–æ–Ω|—Å–º–∞—Ä—Ç—Ñ–æ–Ω)"
                ],
                "keywords": ["—Ç–µ–ª–µ—Ñ–æ–Ω", "—Å–º–∞—Ä—Ç—Ñ–æ–Ω" ],
                "responses": [
                    "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ:\n1. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ\n2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏\n3. –û–±–Ω–æ–≤–∏—Ç—å –ü–û",
                    "–î–ª—è –ø—Ä–æ–±–ª–µ–º —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:\n- –ó–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–∏\n- –†–µ–∂–∏–º –ø–æ–ª–µ—Ç–∞\n- SIM-–∫–∞—Ä—Ç—É"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–Ω–µ\s–≥–æ—Ä–∏—Ç|–Ω–µ\s–≥–æ—Ä—è—Ç|–ª–∞–º–ø–æ—á–∫–∞|–ª–∞–º–ø–æ—á–∫–∏)(.*)(–Ω–µ\s—Ä–∞–±–æ—Ç–∞–µ—Ç|–Ω–µ\s–≤–∫–ª—é—á–∞–µ—Ç—Å—è|—Å–ª–æ–º–∞–ª–∞—Å—å)",
                    r"(.*)(–ª–∞–º–ø–æ—á–∫–∞|–ª–∞–º–ø–æ—á–∫–∏)(.*)(–≥–∞—Å–Ω–µ—Ç|–Ω–µ\s—Å–≤–µ—Ç–∏—Ç)"
                ],
                "keywords": ["–ª–∞–º–ø–æ—á–∫–∞", "–Ω–µ –≥–æ—Ä–∏—Ç"],
                "responses": [
                    "–ï—Å–ª–∏ –ª–∞–º–ø–æ—á–∫–∏ –Ω–µ –≥–æ—Ä—è—Ç:\n1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–∞\n2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∏—Ç–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ\n3. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–æ 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–Ω–µ\s—Ä–∞–±–æ—Ç–∞–µ—Ç|–Ω–µ\s–≤–∫–ª—é—á–∞–µ—Ç—Å—è|–≥–ª—é—á–∏—Ç|–Ω–µ\s–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç)(.*)(–∫–∞–º–µ—Ä–∞|–≤–∏–¥–µ–æ–∫–∞–º–µ—Ä–∞|–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ)"
                ],
                "keywords": ["–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", "–∫–∞–º–µ—Ä–∞", "–Ω–∞—Å—Ç—Ä–æ–π–∫–∞", "–∫–∞—á–µ—Å—Ç–≤–æ", "–∑–∞–ø–∏—Å–∏", "–ø–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è", "–∑–∞–≤–∏—Å–∞–µ—Ç", "–Ω–µ —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è", "—Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è"],
                "responses": [
                    "–ï—Å–ª–∏ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:\n1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã\n2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ\n3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ\n4. –ó–≤–æ–Ω–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–æ 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–Ω–µ\s–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç)(.*)(–≤–∏–¥–µ–æ|–∫–∞–º–µ—Ä–∞|–∑–≤—É–∫)(.*)"
                ],
                "keywords": ["–∫–∞–º–µ—Ä–∞", "–∑–≤—É–∫"],
                "responses": [
                    "–ï—Å–ª–∏ –∫–∞–º–µ—Ä–∞ –ø–µ—Ä–µ—Å—Ç–∞–ª–∞ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –∑–≤—É–∫:\n1. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –≤—ã–∫–ª—é—á–∏–≤ –∏–Ω–∂–µ–∫—Ç–æ—Ä (–µ—ë –ø–∏—Ç–∞–Ω–∏–µ) –∏–∑ —Ä–æ–∑–µ—Ç–∫–∏\n2. –°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –ø–æ –Ω–æ–º–µ—Ä—É 3-33-00 –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–Ω–µ\s–≤–∏–¥–Ω–æ|–ø–ª–æ—Ö–æ–µ\s–∫–∞—á–µ—Å—Ç–≤–æ|)(.*)(–∫–∞–º–µ—Ä–µ|–∞—Ä—Ö–∏–≤–µ)(.*)"
                ],
                "keywords": ["–Ω–µ –≤–∏–¥–Ω–æ", "–ø–ª–æ—Ö–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ", "–æ–±—ä–µ–∫—Ç–∏–≤", " –∫–∞—Ä—Ç–∏–Ω–∫–∞"],
                "responses": [
                    "–ï—Å–ª–∏ –∫–∞–º–µ—Ä–∞ –Ω–µ —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è:\n1. –£—Ç–æ—á–Ω–∏—Ç–µ —á–∏—Å—Ç–∞ –ª–∏ –ª–∏–Ω–∑–∞ —Å–∞–º–æ–π –∫–∞–º–µ—Ä—ã\n2. –û—á–∏—Å—Ç–∏—Ç–µ –æ–±—ä–µ–∫—Ç–∏–≤\n3. –ó–≤–æ–Ω–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–æ 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–Ω–µ—Ç\s–¥–æ—Å—Ç—É–ø–∞)(.*)(–∞—Ä—Ö–∏–≤)(.*)"
                ],
                "keywords": ["–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞", "–∞—Ä—Ö–∏–≤", "–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∏ –∫–∞–º–µ—Ä—ã"],
                "responses": [
                    "–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞–ø–∏—Å—è–º –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è:\n1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è\n2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞\n3. –ó–≤–æ–Ω–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–æ 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)(iptv\s–Ω–µ\s–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç\s–∫–∞–Ω–∞–ª—ã|—á–µ—Ä–Ω—ã–π\s—ç–∫—Ä–∞–Ω\s–Ω–∞\s—Ç–≤)(.*)"
                ],
                "keywords": ["iptv", "—á–µ—Ä–Ω—ã–π —ç–∫—Ä–∞–Ω","IPTV","–∏–ø—Ç–≤","—Ç–µ–ª–µ–≤–∏–∑–æ—Ä"],
                "responses": [
                    "–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å IPTV:\n1. –ù–∞–∂–º–∏—Ç–µ '–ò—Å—Ç–æ—á–Ω–∏–∫' –Ω–∞ –ø—É–ª—å—Ç–µ ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ HDMI\n2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–∏—Å—Ç–∞–≤–∫—É (–æ—Ç–∫–ª—é—á–∏—Ç–µ –Ω–∞ 10 —Å–µ–∫)\n3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–±–µ–ª—å HDMI –Ω–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è"
                ]
            },
            {
                "patterns": [
                    r"(.*)(iptv\s–º–µ–¥–ª–µ–Ω–Ω–æ\s–ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç\s–∫–∞–Ω–∞–ª—ã|–ª–∞–≥–∞–µ—Ç\s–ø—Ä–∏\s—Å–º–µ–Ω–µ\s–∫–∞–Ω–∞–ª–∞)(.*)"
                ],
                "keywords": ["–º–µ–¥–ª–µ–Ω–Ω–æ", "–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ"],
                "responses": [
                    "–†–µ—à–µ–Ω–∏–µ –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è:\n1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (–º–∏–Ω–∏–º—É–º 15 –ú–±–∏—Ç/—Å)\n2. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≤–∫–ª—é—á–∏—Ç–µ '–ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—é'\n3. –û–±–Ω–æ–≤–∏—Ç–µ –ø–ª–µ–π–ª–∏—Å—Ç —á–µ—Ä–µ–∑ '–°–∏—Å—Ç–µ–º–∞ ‚Üí –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ'"
                ]
            },
            {
                "patterns": [
                    r"(.*)(ip\s—Ç–µ–ª–µ—Ñ–æ–Ω\s–Ω–µ\s—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è|–æ—à–∏–±–∫–∞\svoip)(.*)"
                ],
                "keywords": ["—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è", "–Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è"],
                "responses": [
                    "–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π:\n1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SIP-–¥–∞–Ω–Ω—ã–µ –≤ —Ä–∞–∑–¥–µ–ª–µ '–¢–µ–ª–µ—Ñ–æ–Ω–∏—è' –õ–ö\n2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–µ–ª–µ—Ñ–æ–Ω –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ LAN-–ø–æ—Ä—Ç—É\n3. –î–ª—è –æ—Ñ–∏—Å–Ω—ã—Ö –ê–¢–° - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ VLAN"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–ø—Ä–æ–ø–∞–¥–∞–µ—Ç\s–∑–≤—É–∫\s–≤\sip\s—Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏|–ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è\s—Ä–∞–∑–≥–æ–≤–æ—Ä)(.*)"
                ],
                "keywords": ["–∑–≤—É–∫", "–ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è"],
                "responses": [
                    "–ï—Å–ª–∏ –ø—Ä–æ–ø–∞–¥–∞–µ—Ç –∑–≤—É–∫:\n1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è\n2. –û–±–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ—à–∏–≤–∫—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ QoS –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ –¥–ª—è VoIP"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–∂–∞–ª–æ–±–∞|–Ω–µ–¥–æ–≤–æ–ª–µ–Ω|–ø–ª–æ—Ö–æ–π\s—Å–µ—Ä–≤–∏—Å)(.*)"
                ],
                "keywords": ["–∂–∞–ª–æ–±–∞", "–ø–ª–æ—Ö–æ–π —Å–µ—Ä–≤–∏—Å", "–≥—Ä—É–±–æ—Å—Ç—å"],
                "responses": [
                    "–°–æ–∂–∞–ª–µ–µ–º –æ –Ω–µ—É–¥–æ–±—Å—Ç–≤–∞—Ö! –û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É, –∏ –º—ã —Ä–µ—à–∏–º –µ—ë:\n1. –£–∫–∞–∂–∏—Ç–µ —Å—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã\n2. –°–æ–æ–±—â–∏—Ç–µ –≤—Ä–µ–º—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞\n3. –ó–≤–æ–Ω–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–æ 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–æ–ø–ª–∞—Ç–∞|–ø–ª–∞—Ç–µ–∂)(.*)(–∏–Ω—Ç–µ—Ä–Ω–µ—Ç|–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ|—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è|iptv|–∏–ø—Ç–≤)(.*)",
                    r"(.*)(–∫–∞–∫\s–æ–ø–ª–∞—Ç–∏—Ç—å)(.*)(–∏–Ω—Ç–µ—Ä–Ω–µ—Ç|–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ|—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è|iptv|–∏–ø—Ç–≤)(.*)",
                    r"(.*)(–∫–∞–∫\s–æ–ø–ª–∞—Ç–∏—Ç—å)(.*)"
                ],
                "keywords": ["–æ–ø–ª–∞—Ç–∞","—É—Å–ª—É–≥–∞", "–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", "—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è", "iptv","–æ–ø–ª–∞—Ç–∏—Ç—å"],
                "responses": [
                    "–û–ø–ª–∞—Ç–∏—Ç—å —É—Å–ª—É–≥–∏ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è, IP-—Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏ –∏–ª–∏ IPTV –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±–∞–Ω–∫–∞ –∏–ª–∏ –≤ –æ—Ñ–∏—Å–µ",
                    "–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã: –æ–Ω–ª–∞–π–Ω –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ, –≤ –æ—Ñ–∏—Å–µ, —á–µ—Ä–µ–∑ –±–∞–Ω–∫–æ–≤—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –î–ª—è –¥–µ—Ç–∞–ª–µ–π –∑–≤–æ–Ω–∏—Ç–µ 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)(ip\s—Ç–µ–ª–µ—Ñ–æ–Ω\s–Ω–µ\s–∑–≤–æ–Ω–∏—Ç|–Ω–µ\s–ø—Ä–æ—Ö–æ–¥—è—Ç\s–∏—Å—Ö–æ–¥—è—â–∏–µ\s–≤—ã–∑–æ–≤—ã)(.*)",
                    r"(.*)(–Ω–µ\s—Ä–∞–±–æ—Ç–∞–µ—Ç\s–∏—Å—Ö–æ–¥—è—â–∞—è\s—Å–≤—è–∑—å\s–Ω–∞\sip\s—Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏)(.*)"
                ],
                "keywords": ["–Ω–µ –∑–≤–æ–Ω–∏—Ç", "–∏—Å—Ö–æ–¥—è—â–∏–µ –≤—ã–∑–æ–≤—ã"],
                "responses": [
                    "–ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∏—Å—Ö–æ–¥—è—â–∏–µ –≤—ã–∑–æ–≤—ã:\n1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å SIP-–∞–∫–∫–∞—É–Ω—Ç–∞ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ\n2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–æ–º–µ—Ä –Ω–µ –≤ —á–µ—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ\n3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏—Å—Ö–æ–¥—è—â–µ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞ (Outbound Route)\n4. –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞: 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–Ω–µ—Ç\s–∑–≤—É–∫–∞\s–≤\sip\s—Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏|–Ω–µ\s—Å–ª—ã—à–Ω–æ\s—Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞)(.*)",
                    r"(.*)(–∞–±–æ–Ω–µ–Ω—Ç\s–Ω–µ\s—Å–ª—ã—à–∏—Ç\s–º–µ–Ω—è\s–ø—Ä–∏\s—Ä–∞–∑–≥–æ–≤–æ—Ä–µ)(.*)"
                ],
                "keywords": ["–Ω–µ—Ç –∑–≤—É–∫–∞", "–Ω–µ —Å–ª—ã—à–Ω–æ"],
                "responses": [
                    "–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å–æ –∑–≤—É–∫–æ–º:\n1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å –¥–∏–Ω–∞–º–∏–∫–∞/–º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ\n2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∫–æ–¥–µ–∫–æ–≤ –≤—ã–±—Ä–∞–Ω G.711 –∏–ª–∏ G.729\n3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ NAT-—Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—é –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ\n4. –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞: 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)(ip\s—Ç–µ–ª–µ—Ñ–æ–Ω\s–Ω–µ\s—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è\s–Ω–∞\s—Å–µ—Ä–≤–µ—Ä–µ)(.*)",
                    r"(.*)(–æ—à–∏–±–∫–∞\s—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏\svoip\s—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)(.*)"
                ],
                "keywords": ["–Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è", "–æ—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"],
                "responses": [
                    "–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π:\n1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å SIP (—Ä–∞–∑–¥–µ–ª '–¢–µ–ª–µ—Ñ–æ–Ω–∏—è' –≤ –õ–ö)\n2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É\n3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∞—à VoIP-–ø—Ä–æ–≤–∞–π–¥–µ—Ä)\n4. –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞: 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–∑–≤–æ–Ω–∫–∏\s–ø—Ä–µ—Ä—ã–≤–∞—é—Ç—Å—è\s—á–µ—Ä–µ–∑\sN\s—Å–µ–∫—É–Ω–¥)(.*)",
                    r"(.*)(—Ä–∞–∑–≥–æ–≤–æ—Ä\s–æ–±—Ä—ã–≤–∞–µ—Ç—Å—è\s—á–µ—Ä–µ–∑\s–Ω–µ–∫–æ—Ç–æ—Ä–æ–µ\s–≤—Ä–µ–º—è)(.*)"
                ],
                "keywords": ["–ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è", "–æ–±—Ä—ã–≤–∞–µ—Ç—Å—è"],
                "responses": [
                    "–ï—Å–ª–∏ –∑–≤–æ–Ω–∫–∏ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç—Å—è:\n1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (ping < 100ms)\n2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ QoS –¥–ª—è VoIP-—Ç—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ\n3. –£–º–µ–Ω—å—à–∏—Ç–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª keepalive –¥–æ 20 —Å–µ–∫\n4. –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞: 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)(—ç—Ö–æ\s–≤\sip\s—Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏|—Å–ª—ã—à—É\s—Å–≤–æ–π\s–≥–æ–ª–æ—Å)(.*)"
                ],
                "keywords": ["—ç—Ö–æ", "—Å–≤–æ–π –≥–æ–ª–æ—Å","—Å–µ–±—è"],
                "responses": [
                    "–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å —ç—Ö–æ–º:\n1. –£–º–µ–Ω—å—à–∏—Ç–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å –¥–∏–Ω–∞–º–∏–∫–∞ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ\n2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–∞—Ä–Ω–∏—Ç—É—Ä—É –≤–º–µ—Å—Ç–æ –≥—Ä–æ–º–∫–æ–π —Å–≤—è–∑–∏\n3. –í–∫–ª—é—á–∏—Ç–µ –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ —ç—Ö–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n4. –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞: 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–∫–∞–∫\s–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å\sip\s—Ç–µ–ª–µ—Ñ–æ–Ω\s–≤–ø–µ—Ä–≤—ã–µ)(.*)",
                    r"(.*)(–ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è\s–Ω–∞—Å—Ç—Ä–æ–π–∫–∞\svoip)(.*)"
                ],
                "keywords": ["–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å", "–ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞"],
                "responses": [
                    "–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ IP-—Ç–µ–ª–µ—Ñ–æ–Ω–∞:\n1. –í–≤–µ–¥–∏—Ç–µ SIP-–ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –∏–∑ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞\n2. –£–∫–∞–∂–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: voip.provider.ru\n3. –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–¥–µ–∫ G.711 –∏–ª–∏ G.729\n4. –î–ª—è –ø–æ–º–æ—â–∏ –∑–≤–æ–Ω–∏—Ç–µ 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)(—Ç–∞—Ä–∏—Ñ—ã)(.*)",
                    r"(.*)(–∞–∫—Ü–∏–∏)(.*)"
                ],
                "keywords": ["—Ç–∞—Ä–∏—Ñ", "—Å—Ç–æ–∏–º–æ—Å—Ç—å", "–∞–∫—Ü–∏–∏"],
                "responses": [
                    "–ê–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º –∏ –∞–∫—Ü–∏—è–º:\n1. –°–º–æ—Ç—Ä–∏—Ç–µ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª–µ '–¢–µ–ª–µ—Ñ–æ–Ω–∏—è'\n2. –ò–ª–∏ —É—Ç–æ—á–Ω–∏—Ç–µ —É –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É 3-33-00\n3. –¢–µ–∫—É—â–∏–µ –∞–∫—Ü–∏–∏: –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –º–µ–∂–¥—É–≥–æ—Ä–æ–¥–Ω–∏–µ –∑–≤–æ–Ω–∫–∏ –ø–æ –≤—ã—Ö–æ–¥–Ω—ã–º"
                ]
            },
            {
                "patterns": [
                    r"(.*)(—Å—Ç–æ–∏–º–æ—Å—Ç—å|—Ü–µ–Ω–∞|—Å–∫–æ–ª—å–∫–æ\s—Å—Ç–æ–∏—Ç)(.*)(–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ|—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è|iptv|–∏–ø—Ç–≤)",
                    r"(.*)(–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ|—É—Å—Ç–∞–Ω–æ–≤–∫–∞)(.*)(–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ|—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è|iptv|–∏–ø—Ç–≤)"
                ],
                "keywords": ["—Å—Ç–æ–∏–º–æ—Å—Ç—å", "–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", "—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è", "iptv", "–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ"],
                "responses": [
                    "–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è, IP-—Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏ –∏–ª–∏ IPTV –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∞—Ä–∏—Ñ–∞ –∏ –∞–¥—Ä–µ—Å–∞. –î–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –∑–≤–æ–Ω–∏—Ç–µ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É 3-33-00",
                    "–î–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è —Ü–µ–Ω—ã –Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫—É —É—Å–ª—É–≥ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –æ—Ñ–∏—Å –∏–ª–∏ –ø–æ–∑–≤–æ–Ω–∏—Ç–µ –ø–æ –Ω–æ–º–µ—Ä—É 3-33-00"
                ]
            },
            {
                "patterns": [
                    r"(.*)(–ø—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ)(.*)",
                    r"(.*)(–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è)(.*)"
                ],
                "keywords": [],
                "responses": [
                    "–ò–∑–≤–∏–Ω–∏—Ç–µ, —è –Ω–µ –ø–æ–Ω—è–ª. –ú–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å? –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–ø—Ä–æ—Å–∏—Ç–µ –ø—Ä–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ, IP-—Ç–µ–ª–µ—Ñ–æ–Ω–∏—é –∏–ª–∏ IPTV.",
                    "–£—Ç–æ—á–Ω–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–∞—à –≤–æ–ø—Ä–æ—Å. –Ø –Ω–µ –ø–æ–Ω—è–ª –æ —á–µ–º –≤—ã."
                ]
            },
            {
                "patterns": [r".*"],
                "keywords": [],
                "responses": [
                    "–ò–∑–≤–∏–Ω–∏—Ç–µ, —è –Ω–µ –ø–æ–Ω—è–ª. –ú–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å? –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–ø—Ä–æ—Å–∏—Ç–µ –ø—Ä–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ, IP-—Ç–µ–ª–µ—Ñ–æ–Ω–∏—é –∏–ª–∏ IPTV.",
                    "–£—Ç–æ—á–Ω–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–∞—à –≤–æ–ø—Ä–æ—Å. –Ø –Ω–µ –ø–æ–Ω—è–ª –æ —á–µ–º –≤—ã."
                ]
            }
        ]

    def preprocess_text(self, text):
        # –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º spaCy
        logging.debug(f"Preprocessing text: {text}")
        try:
            # –£–¥–∞–ª—è–µ–º –ª–∏—à–Ω–∏–µ —Å–∏–º–≤–æ–ª—ã –∏ –ø—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
            text = re.sub(r'[^\w\s]', '', text.lower())
            doc = self.nlp(text)
            # –õ–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–æ–ø-—Å–ª–æ–≤
            tokens = [token.lemma_ for token in doc if not token.is_stop and len(token.text) > 2]
            return tokens
        except Exception as e:
            logging.error(f"Text preprocessing error: {e}", exc_info=True)
            return []

    def _correct_spelling(self, token, dictionary):
        #–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—á–∞—Ç–æ–∫ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º fuzzywuzzy –∏ get_close_matches
        try:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–æ–≤–∞—Ä—å —á–∞—Å—Ç—ã—Ö –æ—à–∏–±–æ–∫
            for correct_word, typos in self.typo_dictionary.items():
                if token in typos:
                    logging.debug(f"Corrected '{token}' to '{correct_word}' using typo dictionary")
                    return correct_word
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ö–æ–∂–µ—Å—Ç—å —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏
            matches = get_close_matches(token, dictionary, n=1, cutoff=0.5)
            if matches:
                logging.debug(f"Corrected '{token}' to '{matches[0]}' using get_close_matches")
                self._add_typo_to_db(matches[0], token)
                return matches[0]
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å fuzzywuzzy
            best_match = None
            best_score = 0
            for word in dictionary:
                score = fuzz.ratio(token, word)
                if score > 50 and score > best_score:  # –ü–æ–Ω–∏–∂–µ–Ω–Ω—ã–π –ø–æ—Ä–æ–≥
                    best_match = word
                    best_score = score
            if best_match:
                logging.debug(f"Corrected '{token}' to '{best_match}' using fuzzywuzzy (score: {best_score})")
                self._add_typo_to_db(best_match, token)
                return best_match
            # –õ–æ–≥–∏—Ä—É–µ–º –Ω–µ—Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω–æ–µ —Å–ª–æ–≤–æ
            logging.info(f"Unrecognized token: '{token}'", extra={'logger_name': 'unrecognized'})
            return token
        except Exception as e:
            logging.error(f"Spelling correction error for '{token}': {e}", exc_info=True)
            return token

    def _match_pattern_score(self, text, pattern, keywords):
        #–û—Ü–µ–Ω–∏–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —à–∞–±–ª–æ–Ω—É (–æ—Ç 0 –¥–æ 1).
        try:
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–º—É –≤—ã—Ä–∞–∂–µ–Ω–∏—é
            if re.fullmatch(pattern, text, re.IGNORECASE):
                return 1.0  # –ü–æ–ª–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
            # –õ–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
            tokens = self.preprocess_text(text)
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—â–∏–π —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–ø–µ—á–∞—Ç–æ–∫, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ keywords —Ç–µ–∫—É—â–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            all_keywords = set(kw for cat in self.knowledge_base for kw in cat.get("keywords", []))
            dictionary = all_keywords if all_keywords else set(keywords)
            corrected_tokens = [self._correct_spelling(token, dictionary) for token in tokens]
            # –û—Ü–µ–Ω–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–≤–ø–∞–≤—à–∏—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
            stemmed_keywords = [self.nlp(keyword)[0].lemma_ for keyword in keywords]
            matched_keywords = sum(1 for kw in stemmed_keywords if kw in corrected_tokens) # –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–ø–µ—á–∞—Ç–∫–∞: atched -> matched
            # –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å
            keyword_count = len(keywords)
            if keyword_count == 0:
                 return 0.5 # –ò–ª–∏ –¥—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –±–µ–∑ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
            return min(1.0, matched_keywords / keyword_count) # –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞
        except Exception as e:
            logging.error(f"Scoring error for pattern '{pattern}': {e}", exc_info=True)
            return 0.0

    def get_response(self, text):
        best_match = None
        best_score = 0
        for category in self.knowledge_base:
            for pattern in category["patterns"]:
                match_score = self._match_pattern_score(text, pattern, category["keywords"])
                if match_score > best_score:
                    best_score = match_score
                    best_match = category
        if best_match and best_score > 0.7:  # –ü–æ—Ä–æ–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
            return random.choice(best_match["responses"])
        else:
            # –õ–æ–≥–∏—Ä—É–µ–º –Ω–µ—Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
            self._add_unrecognized_query_to_db(text)
            return "–ò–∑–≤–∏–Ω–∏—Ç–µ, —è –Ω–µ –ø–æ–Ω—è–ª. –£—Ç–æ—á–Ω–∏—Ç–µ –≤–æ–ø—Ä–æ—Å?"

